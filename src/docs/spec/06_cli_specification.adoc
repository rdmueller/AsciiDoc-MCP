= dacli - Docs-As-Code CLI Specification
:toc:
:toclevels: 3

== Übersicht

`dacli` (Docs-As-Code CLI) ermöglicht die Nutzung aller Dokumentations-Tools über die Kommandozeile.
Dies ist besonders nützlich für LLMs, die keinen MCP-Support haben, aber Bash/Shell-Tools verwenden können.

== Globale Optionen

[source,bash]
----
dacli [OPTIONS] <COMMAND> [ARGS]

Options:
  --docs-root PATH    Dokumentations-Wurzelverzeichnis (default: $PROJECT_PATH oder cwd)
  --format FORMAT     Ausgabeformat: text (default), json, yaml
  --pretty            Formatierte Ausgabe für Menschen
  --quiet, -q         Unterdrückt Warnmeldungen
  --no-gitignore      Dateien einbeziehen, die normalerweise durch .gitignore-Muster ausgeschlossen würden
  --include-hidden    Dateien in versteckten Verzeichnissen (beginnend mit '.') einbeziehen
  --version           Zeigt Version
  --help              Zeigt Hilfe
----

== Navigation Commands

=== structure

Zeigt die hierarchische Dokumentstruktur.

[source,bash]
----
dacli structure [--max-depth N]
----

**Beispiel:**
[source,bash]
----
$ dacli structure --max-depth 1
{
  "sections": [
    {"path": "introduction", "title": "Introduction", "level": 1},
    {"path": "architecture", "title": "Architecture", "level": 1}
  ],
  "total_sections": 15
}
----

=== section

Liest den Inhalt einer Sektion.

[source,bash]
----
dacli section <PATH>
----

**Beispiel:**
[source,bash]
----
$ dacli section introduction.goals
{
  "path": "introduction.goals",
  "title": "Goals",
  "content": "== Goals\n\nThis section...",
  "format": "asciidoc"
}
----

=== sections-at-level

Zeigt alle Sektionen auf einer bestimmten Ebene.

[source,bash]
----
dacli sections-at-level <LEVEL>
----

== Search & Elements Commands

=== search

Durchsucht die Dokumentation.

[source,bash]
----
dacli search <QUERY> [--scope PATH] [--max-results N]
----

**Beispiel:**
[source,bash]
----
$ dacli search "authentication" --max-results 5
{
  "query": "authentication",
  "results": [
    {"path": "security.auth", "context": "...implements authentication...", "score": 0.95}
  ],
  "total_results": 1
}
----

=== elements

Listet Elemente (Code-Blöcke, Tabellen, etc.).

[source,bash]
----
dacli elements [--type TYPE] [--section PATH]
----

**Type-Optionen:** `code`, `table`, `image`, `diagram`, `list`, `admonition`

== Meta-Information Commands

=== metadata

Zeigt Metadaten für Projekt oder Sektion.

[source,bash]
----
dacli metadata [PATH]
----

**Projekt-Metadaten (ohne PATH):**
[source,bash]
----
$ dacli metadata
{
  "total_files": 15,
  "total_sections": 87,
  "total_words": 12450,
  "formats": ["asciidoc", "markdown"]
}
----

**Sektions-Metadaten (mit PATH):**
[source,bash]
----
$ dacli metadata architecture.decisions
{
  "path": "architecture.decisions",
  "title": "Architecture Decisions",
  "word_count": 2340,
  "subsection_count": 5
}
----

=== validate

Validiert die Dokumentstruktur.

[source,bash]
----
dacli validate
----

**Beispiel:**
[source,bash]
----
$ dacli validate
{
  "valid": true,
  "errors": [],
  "warnings": [
    {"type": "orphaned_file", "path": "unused.adoc"}
  ],
  "validation_time_ms": 45
}
----

== Manipulation Commands

=== update

Aktualisiert den Inhalt einer Sektion.

[source,bash]
----
dacli update <PATH> --content "..." [--no-preserve-title] [--expected-hash HASH]
----

**Beispiel:**
[source,bash]
----
$ dacli update introduction --content "New introduction text..."
{
  "success": true,
  "path": "introduction",
  "previous_hash": "a1b2c3d4",
  "new_hash": "e5f6g7h8"
}
----

=== insert

Fügt Inhalt relativ zu einer Sektion ein.

[source,bash]
----
dacli insert <PATH> --position before|after|append --content "..."
----

**Beispiel:**
[source,bash]
----
$ dacli insert architecture --position after --content "== New Section\n\nContent..."
{
  "success": true,
  "inserted_at": {"file": "arc42.adoc", "line": 150}
}
----

== Exit Codes

[cols="1,3"]
|===
| Code | Bedeutung

| 0 | Erfolg
| 1 | Allgemeiner Fehler
| 2 | Ungültige Argumente
| 3 | Pfad nicht gefunden
| 4 | Validierungsfehler
| 5 | Schreibfehler
|===

== LLM-Integration Beispiel

Ein LLM kann das CLI über Bash-Tools verwenden:

[source,bash]
----
# Struktur abfragen
structure=$(dacli structure --max-depth 2 --docs-root /project/docs)

# Nach Thema suchen
results=$(dacli search "database" | jq '.results[].path')

# Sektion lesen
content=$(dacli section architecture.decisions)

# Dokumentation aktualisieren
dacli update api.endpoints --content "Updated API documentation..."
----
