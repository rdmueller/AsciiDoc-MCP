= dacli - Docs-As-Code CLI Specification
:toc:
:toclevels: 3

== Overview

`dacli` (Docs-As-Code CLI) enables the use of all documentation tools via the command line.
This is especially useful for LLMs that don't have MCP support but can use Bash/Shell tools.

== Global Options

[source,bash]
----
dacli [OPTIONS] <COMMAND> [ARGS]

Options:
  --docs-root PATH    Documentation root directory (default: $PROJECT_PATH or cwd)
  --format FORMAT     Output format: text (default), json, yaml
  --pretty            Formatted output for humans
  --verbose, -v       Show warning messages (default: only errors shown)
  --no-gitignore      Include files that would normally be excluded by .gitignore patterns
  --include-hidden    Include files in hidden directories (starting with '.')
  --version           Show version
  --help              Show help
----

== Navigation Commands

=== structure

Shows the hierarchical document structure.

[source,bash]
----
dacli structure [--max-depth N]
----

**Example:**
[source,bash]
----
$ dacli structure --max-depth 1
{
  "sections": [
    {"path": "introduction", "title": "Introduction", "level": 1},
    {"path": "architecture", "title": "Architecture", "level": 1}
  ],
  "total_sections": 15
}
----

=== section

Reads the content of a section.

[source,bash]
----
dacli section <PATH>
----

**Example:**
[source,bash]
----
$ dacli section introduction.goals
{
  "path": "introduction.goals",
  "title": "Goals",
  "content": "== Goals\n\nThis section...",
  "format": "asciidoc"
}
----

=== sections-at-level

Shows all sections at a specific level.

[source,bash]
----
dacli sections-at-level <LEVEL>
----

== Search & Elements Commands

=== search

Searches the documentation.

[source,bash]
----
dacli search <QUERY> [--scope PATH] [--max-results N]
----

**Example:**
[source,bash]
----
$ dacli search "authentication" --max-results 5
{
  "query": "authentication",
  "results": [
    {"path": "security.auth", "context": "...implements authentication...", "score": 0.95}
  ],
  "total_results": 1
}
----

=== elements

Lists elements (code blocks, tables, etc.).

[source,bash]
----
dacli elements [--type TYPE] [--section PATH]
----

**Type options:** `code`, `table`, `image`, `diagram`, `list`, `admonition`

== Meta-Information Commands

=== metadata

Shows metadata for project or section.

[source,bash]
----
dacli metadata [PATH]
----

**Project metadata (without PATH):**
[source,bash]
----
$ dacli metadata
{
  "total_files": 15,
  "total_sections": 87,
  "total_words": 12450,
  "formats": ["asciidoc", "markdown"]
}
----

**Section metadata (with PATH):**
[source,bash]
----
$ dacli metadata architecture.decisions
{
  "path": "architecture.decisions",
  "title": "Architecture Decisions",
  "word_count": 2340,
  "subsection_count": 5
}
----

=== validate

Validates the documentation structure.

[source,bash]
----
dacli validate
----

**Example:**
[source,bash]
----
$ dacli validate
{
  "valid": true,
  "errors": [],
  "warnings": [
    {"type": "orphaned_file", "path": "unused.adoc"}
  ],
  "validation_time_ms": 45
}
----

== Manipulation Commands

=== update

Updates the content of a section.

[source,bash]
----
dacli update <PATH> --content "..." [--no-preserve-title] [--expected-hash HASH]
----

**Example:**
[source,bash]
----
$ dacli update introduction --content "New introduction text..."
{
  "success": true,
  "path": "introduction",
  "previous_hash": "a1b2c3d4",
  "new_hash": "e5f6g7h8"
}
----

=== insert

Inserts content relative to a section.

[source,bash]
----
dacli insert <PATH> --position before|after|append --content "..."
----

**Example:**
[source,bash]
----
$ dacli insert architecture --position after --content "== New Section\n\nContent..."
{
  "success": true,
  "inserted_at": {"file": "arc42.adoc", "line": 150}
}
----

== Exit Codes

[cols="1,3"]
|===
| Code | Meaning

| 0 | Success
| 1 | General error
| 2 | Invalid arguments
| 3 | Path not found
| 4 | Validation error
| 5 | Write error
|===

== LLM Integration Example

An LLM can use the CLI via Bash tools:

[source,bash]
----
# Query structure
structure=$(dacli structure --max-depth 2 --docs-root /project/docs)

# Search for topic
results=$(dacli search "database" | jq '.results[].path')

# Read section
content=$(dacli section architecture.decisions)

# Update documentation
dacli update api.endpoints --content "Updated API documentation..."
----
