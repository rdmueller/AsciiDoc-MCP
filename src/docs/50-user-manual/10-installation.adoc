= Installation Guide
:toc:
:toclevels: 3

== Overview

The dacli - Documentation Access enables LLM interaction with AsciiDoc and Markdown documentation projects. This guide covers installation on all supported platforms.

== Prerequisites

=== uv Package Manager

The only prerequisite is https://github.com/astral-sh/uv[uv], which handles Python installation automatically.

**Install uv:**

[tabs]
====
Linux/macOS::
+
[source,bash]
----
curl -LsSf https://astral.sh/uv/install.sh | sh
----

Windows (PowerShell)::
+
[source,powershell]
----
powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"
----
====

**Verify installation:**
[source,bash]
----
uv --version
----

NOTE: uv will automatically download and manage Python 3.12+ when you run `uv sync`. You do not need to install Python separately.

== Installation

=== Clone the Repository

[source,bash]
----
git clone https://github.com/docToolchain/dacli.git
cd dacli
----

=== Option A: Global Installation (Recommended)

Install `dacli` and `mcp-docs-server` as global commands:

[source,bash]
----
uv tool install .
----

This installs the tools globally, so you can use them directly:

[source,bash]
----
dacli --version
mcp-docs-server --help
----

To update after pulling new changes:
[source,bash]
----
uv tool install . --force
----

=== Option B: Development Mode

For development or if you prefer using `uv run`:

[source,bash]
----
uv sync
----

This creates a virtual environment. Run commands with `uv run`:

[source,bash]
----
uv run dacli --version
uv run dacli-mcp --help
----

=== Verify Installation

**Check the CLI:**
[source,bash]
----
dacli --version
# or: uv run dacli --version
----

Expected output:
----
dacli, version 0.1.0
----

**Check the MCP server:**
[source,bash]
----
mcp-docs-server --help
# or: uv run dacli-mcp --help
----

Expected output:
----
usage: dacli-mcp [-h] [--docs-root DOCS_ROOT]

dacli - Documentation Access

options:
  -h, --help            show this help message and exit
  --docs-root DOCS_ROOT
                        Root directory containing documentation files
----

== Configuration

=== Claude Desktop

Add the server to your Claude Desktop configuration file:

[tabs]
====
Linux::
+
`~/.config/claude-desktop/config.json`

macOS::
+
`~/Library/Application Support/Claude/claude_desktop_config.json`

Windows::
+
`%APPDATA%\Claude\claude_desktop_config.json`
====

**Configuration content:**
[source,json]
----
{
  "mcpServers": {
    "dacli": {
      "command": "uv",
      "args": [
        "run",
        "--directory", "/path/to/dacli",
        "dacli-mcp",
        "--docs-root", "/path/to/your/documentation"
      ]
    }
  }
}
----

IMPORTANT: Replace `/path/to/dacli` with the actual path where you cloned the repository, and `/path/to/your/documentation` with the path to your documentation project.

=== Claude Code (CLI)

Add to your Claude Code MCP settings (`~/.config/claude-code/settings.json` or via `claude mcp add`):

[source,json]
----
{
  "mcpServers": {
    "dacli": {
      "command": "uv",
      "args": [
        "run",
        "--directory", "/path/to/dacli",
        "dacli-mcp",
        "--docs-root", "/path/to/your/documentation"
      ]
    }
  }
}
----

=== Amazon Q CLI / Kiro

[source,json]
----
{
  "mcpServers": {
    "dacli": {
      "command": "uv",
      "args": [
        "run",
        "--directory", "/path/to/dacli",
        "dacli-mcp",
        "--docs-root", "/path/to/documentation"
      ]
    }
  }
}
----

== Running the Server

=== Standalone Mode

For testing or debugging, run the server directly:

[source,bash]
----
uv run dacli-mcp --docs-root /path/to/your/docs
----

=== Using the CLI

For LLMs without MCP support, use the `dacli` command-line interface:

[source,bash]
----
# Get documentation structure
dacli --docs-root /path/to/docs structure

# Search documentation
dacli --docs-root /path/to/docs search "authentication"

# Read a section
dacli --docs-root /path/to/docs section introduction
----

NOTE: If you used Option B (development mode), prefix commands with `uv run`.

See the xref:50-tutorial.adoc[CLI Tutorial] for comprehensive examples.

== Troubleshooting

=== Common Issues

==== "uv: command not found"

The uv package manager is not installed or not in your PATH.

**Solution:** Reinstall uv and ensure your shell configuration is reloaded:
[source,bash]
----
# Reinstall
curl -LsSf https://astral.sh/uv/install.sh | sh

# Reload shell (or open a new terminal)
source ~/.bashrc  # or ~/.zshrc
----

==== "Module not found" errors

Dependencies are not installed.

**Solution:** Run `uv sync` in the project directory:
[source,bash]
----
cd /path/to/dacli
uv sync
----

==== MCP server not connecting in Claude Desktop

**Check:**

1. The paths in your config are absolute paths (not relative)
2. The `--directory` path points to the dacli folder
3. The `--docs-root` path points to your documentation folder
4. Both paths exist and are accessible

**Debug:** Try running the server manually to see error messages:
[source,bash]
----
uv run --directory /path/to/dacli dacli-mcp --docs-root /path/to/docs
----

==== "Permission denied" on Linux/macOS

**Solution:** Ensure the files are readable:
[source,bash]
----
chmod -R u+r /path/to/your/docs
----

=== Getting Help

- GitHub Issues: https://github.com/docToolchain/dacli/issues
- Documentation: See the other files in this user manual

== Updating

To update to the latest version:

[source,bash]
----
cd /path/to/dacli
git pull
uv sync
----

== Uninstallation

To remove the server:

[source,bash]
----
# Remove the repository
rm -rf /path/to/dacli

# Remove MCP configuration from Claude Desktop
# (Edit your config.json and remove the "dacli" entry)
----
